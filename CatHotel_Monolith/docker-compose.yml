version: '3.4'

services:
  ms-sql-server:
    image: mcr.microsoft.com/mssql/server
    environment:
       ACCEPT_EULA: "Y"
       SA_PASSWORD: "StrongPassword???"
       MSSQL_PID: Express
    ports:
       - "1433:1433"
    container_name: "ms-sql-server"

  cathotel_monolith:
    image: ${DOCKER_REGISTRY-}cathotelmonolith
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - 80
    container_name: "cathotel_monolith"
  
  proxy:
    image: dockercloud/haproxy
    ports: 
      - "80:80"
    links: 
      - cathotel_monolith
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    container_name: "haproxy"